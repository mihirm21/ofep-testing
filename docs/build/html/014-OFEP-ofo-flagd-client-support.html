<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>flagd client support driven by OpenFeature Operator &mdash; OFEP-TESTING 1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            OFEP-TESTING
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">flagd client support driven by OpenFeature Operator</a></li>
<li><a class="reference internal" href="#state-withdrawn">State: WITHDRAWN</a></li>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#assumptions">Assumptions</a></li>
<li><a class="reference internal" href="#proposal">Proposal</a></li>
<li><a class="reference internal" href="#limitations">Limitations</a></li>
<li><a class="reference internal" href="#proof-of-concept">Proof of concept</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OFEP-TESTING</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">flagd client support driven by OpenFeature Operator</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/014-OFEP-ofo-flagd-client-support.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flagd-client-support-driven-by-openfeature-operator">
<h1>flagd client support driven by OpenFeature Operator<a class="headerlink" href="#flagd-client-support-driven-by-openfeature-operator" title="Permalink to this heading"></a></h1>
</section>
<section id="state-withdrawn">
<h1>State: WITHDRAWN<a class="headerlink" href="#state-withdrawn" title="Permalink to this heading"></a></h1>
<p>Client side applications (e.g. web/mobile) could benefit from access to feature flags. This OFEP outlines the feasibility and benefits of extending <a class="reference external" href="https://github.com/open-feature/open-feature-operator">OpenFeature Operator (OFO)</a> to manage the deployment of flagd with access from external traffic (e.g. client side applications).</p>
<p><em>Withdrawn for the following reasons:</em></p>
<ul class="simple">
<li><p><em>There’s a huge variety of unknown deployment patterns by potential users. Catering to one likely means scope creep to support many in future. Perhaps this is the future path of OFO but an agreement has been reached that it is best to keep things simple and minimally scoped at this stage (until common deployment patterns are more established).</em></p></li>
<li><p><em>OFO would require CRUD permissions for HTTPRoutes &amp; Gateways, introducing security concerns.</em></p></li>
<li><p><em>Kubernetes Gateway API is still in beta.</em></p></li>
</ul>
<p><em><a class="reference internal" href="#./OFEP-ofo-flag-service.md"><span class="xref myst">OFEP for an alternative solution</span></a>.</em></p>
</section>
<section id="background">
<h1>Background<a class="headerlink" href="#background" title="Permalink to this heading"></a></h1>
<p>OFO already manages the deployment of flagd in server side contexts by injecting it as a sidecar container to an existing workload. This permits the workload to communicate with flagd due to the inherent nature of networking between containers within a pod. Conversely, the routing of client side applications to flagd is not trivial. OFO could bear this burden by configuring the cluster as necessary (see the proposal below) to facilitate the deployment of externally accessible (by client side applications) flagd.</p>
</section>
<section id="assumptions">
<h1>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this heading"></a></h1>
<p>The (simplified) deployment pattern is as follows</p>
<ul class="simple">
<li><p>Deployment of a client side application exposed by a Service</p></li>
<li><p><a class="reference external" href="https://gateway-api.sigs.k8s.io/api-types/gateway/">Gateway</a> exposing the app’s Service via a <a class="reference external" href="https://gateway-api.sigs.k8s.io/api-types/httproute/">HTTPRoute</a> and listener</p></li>
</ul>
<p>The networking infrastructure for ingesting external traffic is already in place for the existing client side application.</p>
</section>
<section id="proposal">
<h1>Proposal<a class="headerlink" href="#proposal" title="Permalink to this heading"></a></h1>
<p>Introduce a custom resource definition (CRD) with configuration permitting OFO to create a deployment of flagd and inject the necessary networking configuration to route incoming traffic from the existing Gateway to flagd (via a new HTTPRoute/GRPCRoute).
This results in flagd being externally accessible.</p>
<p>The following diagram depicts the architecture. Resources inside the green box are created via the proposed CRD.</p>
<p><img alt="OFO client architecture" src="_images/ofo-flagd-client-support-architecture.png" /></p>
<p>Note: The example depicted by the diagram uses a subdomain to route the request to flagd but <a class="reference external" href="https://gateway-api.sigs.k8s.io/api-types/httproute/#matches">path matching is also possible</a>.</p>
</section>
<section id="limitations">
<h1>Limitations<a class="headerlink" href="#limitations" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="https://gateway-api.sigs.k8s.io/">Kubernetes Gateway API (KGA)</a> is in beta (as are its implementors). This OFEP could be extended (or a new one created) to also support <a class="reference external" href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Ingress</a>.
The <a class="reference external" href="https://gateway-api.sigs.k8s.io/api-types/grpcroute/">GRPCRoute</a> is experimental.</p>
</section>
<section id="proof-of-concept">
<h1>Proof of concept<a class="headerlink" href="#proof-of-concept" title="Permalink to this heading"></a></h1>
<p>A proof of concept has been created <a class="reference external" href="https://github.com/open-feature/open-feature-operator/issues/371#issuecomment-1468511819">here</a> with an executable demonstration of the proposal.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Mihir Mittal.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>